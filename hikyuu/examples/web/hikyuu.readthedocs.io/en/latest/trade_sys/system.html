

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>系统框架 &mdash; Hikyuu Quant Framework 1.0.3 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  

  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Hikyuu Quant Framework 1.0.3 documentation" href="../index.html"/>
        <link rel="up" title="交易系统" href="trade_sys.html"/>
        <link rel="next" title="市场环境判定策略" href="environment.html"/>
        <link rel="prev" title="交易系统" href="trade_sys.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>


<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="system.html" />

<link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = 'trade_sys/system' 		
READTHEDOCS_DATA['source_suffix'] = '.rst'
</script>

<script type="text/javascript" src="../_static/readthedocs-dynamic-include.js"></script>

<!-- end RTD <extrahead> --></head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Hikyuu Quant Framework
          

          
          </a>

          
            
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Hikyuu 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">安装步骤</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">新手入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactive/index.html">交互工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base/index.html">基础设施</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stock_manager.html">证券管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indicator/index.html">技术指标</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trade_manage/trade_manage.html">交易管理</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="trade_sys.html">交易系统</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="system.html#">系统框架</a><ul>
<li class="toctree-l3"><a class="reference internal" href="system.html#id2">创建系统并执行回测</a></li>
<li class="toctree-l3"><a class="reference internal" href="system.html#id3">系统部件枚举定义</a></li>
<li class="toctree-l3"><a class="reference internal" href="system.html#id4">系统基类定义</a></li>
<li class="toctree-l3"><a class="reference internal" href="system.html#id5">交易请求记录</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="environment.html">市场环境判定策略</a></li>
<li class="toctree-l2"><a class="reference internal" href="condition.html">系统有效条件</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal.html">信号指示器</a></li>
<li class="toctree-l2"><a class="reference internal" href="stoploss.html">止损/止赢策略</a></li>
<li class="toctree-l2"><a class="reference internal" href="money_manager.html">资金管理策略</a></li>
<li class="toctree-l2"><a class="reference internal" href="profitgoal.html">盈利目标策略</a></li>
<li class="toctree-l2"><a class="reference internal" href="slippage.html">移滑价差算法</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">C++ 开发者指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">参考资料</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Hikyuu Quant Framework</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="trade_sys.html">交易系统</a> &raquo;</li>
        
      <li>系统框架</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/trade_sys/system.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>系统框架<a class="headerlink" href="system.html#id1" title="Permalink to this headline">¶</a></h1>
<p>系统是指针对针对单个交易对象的完整策略，包括环境判断、系统有效条件、资金管理、止损、止盈、盈利目标、移滑价差的完整策略，用于模拟回测。</p>
<p>公共参数：</p>
<blockquote>
<div><ul class="simple">
<li><strong>delay=True</strong> <em>(bool)</em> : 是否延迟到下一个bar开盘时进行交易</li>
<li><strong>delay_use_current_price=True</strong> <em>(bool)</em> : 延迟操作的情况下，是使用当前交易时bar的价格计算新的止损价/止赢价/目标价还是使用上次计算的结果</li>
<li><strong>max_delay_count=3</strong> <em>(int)</em> : 连续延迟交易请求的限制次数</li>
<li><strong>tp_monotonic=True</strong> <em>(bool)</em> : 止赢单调递增</li>
<li><strong>tp_delay_n=3</strong> <em>(int)</em> : 止盈延迟开始的天数，即止盈策略判断从实际交易几天后开始生效</li>
<li><strong>ignore_sell_sg=False</strong> <em>(bool)</em> : 忽略卖出信号，只使用止损/止赢等其他方式卖出</li>
<li><strong>support_borrow_cash=False</strong> <em>(bool)</em> : 在现金不足时，是否支持借入现金，融资</li>
<li><strong>support_borrow_stock=False</strong> <em>(bool)</em> : 在没有持仓时，是否支持借入证券，融券</li>
</ul>
</div></blockquote>
<div class="section" id="id2">
<h2>创建系统并执行回测<a class="headerlink" href="system.html#id2" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="hikyuu.trade_sys.SYS_Simple">
<code class="descclassname">hikyuu.trade_sys.</code><code class="descname">SYS_Simple</code><span class="sig-paren">(</span><span class="optional">[</span><em>tm=None</em>, <em>mm=None</em>, <em>ev=None</em>, <em>cn=None</em>, <em>sg=None</em>, <em>st=None</em>, <em>tp=None</em>, <em>pg=None</em>, <em>sp=None</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.SYS_Simple" title="Permalink to this definition">¶</a></dt>
<dd><p>创建简单系统实例（每次交易不进行多次加仓或减仓，即每次买入后在卖出时全部卖出），  系统实例在运行时(调用run方法），至少需要一个配套的交易管理实例、一个资金管理策略
和一个信号指示器），可以在创建系统实例后进行指定。如果出现调用run时没有任何输出，
且没有正确结果的时候，可能是未设置tm、sg、mm。进行回测时，使用 run 方法，如:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">#创建模拟交易账户进行回测，初始资金30万</span>
<span class="n">my_tm</span> <span class="o">=</span> <span class="n">crtTM</span><span class="p">(</span><span class="n">initCash</span> <span class="o">=</span> <span class="mi">300000</span><span class="p">)</span>

<span class="c1">#创建信号指示器（以5日EMA为快线，5日EMA自身的10日EMA最为慢线，快线向上穿越慢线时买入，反之卖出）</span>
<span class="n">my_sg</span> <span class="o">=</span> <span class="n">SG_Flex</span><span class="p">(</span><span class="n">OP</span><span class="p">(</span><span class="n">EMA</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)),</span> <span class="n">slow_n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1">#固定每次买入1000股</span>
<span class="n">my_mm</span> <span class="o">=</span> <span class="n">MM_FixedCount</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1">#创建交易系统并运行</span>
<span class="n">sys</span> <span class="o">=</span> <span class="n">SYS_Simple</span><span class="p">(</span><span class="n">tm</span> <span class="o">=</span> <span class="n">my_tm</span><span class="p">,</span> <span class="n">sg</span> <span class="o">=</span> <span class="n">my_sg</span><span class="p">,</span> <span class="n">mm</span> <span class="o">=</span> <span class="n">my_mm</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sm</span><span class="p">[</span><span class="s1">&#39;sz000001&#39;</span><span class="p">],</span> <span class="n">Query</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tm</strong> (<a class="reference internal" href="../trade_manage/TradeManager.html#hikyuu.trade_manage.TradeManager" title="hikyuu.trade_manage.TradeManager"><em>TradeManager</em></a>) &#8211; 交易管理实例</li>
<li><strong>mm</strong> (<em>MoneyManager</em>) &#8211; 资金管理策略</li>
<li><strong>ev</strong> (<a class="reference internal" href="environment.html#hikyuu.trade_sys.EnvironmentBase" title="hikyuu.trade_sys.EnvironmentBase"><em>EnvironmentBase</em></a>) &#8211; 市场环境判断策略</li>
<li><strong>cn</strong> (<a class="reference internal" href="condition.html#hikyuu.trade_sys.ConditionBase" title="hikyuu.trade_sys.ConditionBase"><em>ConditionBase</em></a>) &#8211; 系统有效条件</li>
<li><strong>sg</strong> (<a class="reference internal" href="signal.html#hikyuu.trade_sys.SignalBase" title="hikyuu.trade_sys.SignalBase"><em>SignalBase</em></a>) &#8211; 信号指示器</li>
<li><strong>st</strong> (<a class="reference internal" href="stoploss.html#hikyuu.trade_sys.StoplossBase" title="hikyuu.trade_sys.StoplossBase"><em>StoplossBase</em></a>) &#8211; 止损策略</li>
<li><strong>tp</strong> (<a class="reference internal" href="stoploss.html#hikyuu.trade_sys.StoplossBase" title="hikyuu.trade_sys.StoplossBase"><em>StoplossBase</em></a>) &#8211; 止盈策略</li>
<li><strong>pg</strong> (<a class="reference internal" href="profitgoal.html#hikyuu.trade_sys.ProfitGoalBase" title="hikyuu.trade_sys.ProfitGoalBase"><em>ProfitGoalBase</em></a>) &#8211; 盈利目标策略</li>
<li><strong>sp</strong> (<a class="reference internal" href="slippage.html#hikyuu.trade_sys.SlippageBase" title="hikyuu.trade_sys.SlippageBase"><em>SlippageBase</em></a>) &#8211; 移滑价差算法</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">system实例</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="id3">
<h2>系统部件枚举定义<a class="headerlink" href="system.html#id3" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="hikyuu.trade_sys.System.Part">
<em class="property">class </em><code class="descclassname">System.</code><code class="descname">Part</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.Part" title="Permalink to this definition">¶</a></dt>
<dd><p>系统部件枚举值，系统的买入/卖出等操作可由这些部件触发，用于标识实际交易指令的来源，参见：<code class="xref py py-class docutils literal"><span class="pre">TradeRecord</span></code>。</p>
<p>实际使用中，可使用 System.ENVIRONMENT 的简化方式 代替 System.Part.ENVIRONMENT，其他与此类似。</p>
<ul class="simple">
<li>System.Part.ENVIRONMENT  - 市场环境判断策略</li>
<li>System.Part.CONDITION    - 系统有效条件</li>
<li>System.Part.SIGNAL       - 信号指示器</li>
<li>System.Part.STOPLOSS     - 止损策略</li>
<li>System.Part.TAKEPROFIT   - 止盈策略</li>
<li>System.Part.MONEYMANAGER - 资金管理策略</li>
<li>System.Part.PROFITGOAL   - 盈利目标策略</li>
<li>System.Part.SLIPPAGE     - 移滑价差算法</li>
<li>System.Part.INVALID      - 无效值边界，大于等于该值时为无效部件</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="hikyuu.trade_sys.getSystemPartName">
<code class="descclassname">hikyuu.trade_sys.</code><code class="descname">getSystemPartName</code><span class="sig-paren">(</span><em>part</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.getSystemPartName" title="Permalink to this definition">¶</a></dt>
<dd><p>获取部件的字符串名称</p>
<blockquote>
<div><ul class="simple">
<li>System.Part.ENVIRONMENT  - &#8220;EV&#8221;</li>
<li>System.Part.CONDITION    - &#8220;CN&#8221;</li>
<li>System.Part.SIGNAL       - &#8220;SG&#8221;</li>
<li>System.Part.STOPLOSS     - &#8220;ST&#8221;</li>
<li>System.Part.TAKEPROFIT   - &#8220;TP&#8221;</li>
<li>System.Part.MONEYMANAGER - &#8220;MM&#8221;</li>
<li>System.Part.PROFITGOAL   - &#8220;PG&#8221;</li>
<li>System.Part.SLIPPAGE     - &#8220;SP&#8221;</li>
<li>System.Part.INVALID      - &#8220;&#8211;&#8221;</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>part</strong> (<em>int</em>) &#8211; System.Part 枚举值</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="hikyuu.trade_sys.getSystemPartEnum">
<code class="descclassname">hikyuu.trade_sys.</code><code class="descname">getSystemPartEnum</code><span class="sig-paren">(</span><em>part_name</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.getSystemPartEnum" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>根据系统部件的字符串名称获取相应的枚举值</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>part_name</strong> (<em>str</em>) &#8211; 系统部件的字符串名称，参见：<a class="reference internal" href="system.html#hikyuu.trade_sys.getSystemPartName" title="hikyuu.trade_sys.getSystemPartName"><code class="xref py py-func docutils literal"><span class="pre">getSystemPartName()</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="system.html#hikyuu.trade_sys.System.Part" title="hikyuu.trade_sys.System.Part">System.Part</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="id4">
<h2>系统基类定义<a class="headerlink" href="system.html#id4" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="hikyuu.trade_sys.System">
<em class="property">class </em><code class="descclassname">hikyuu.trade_sys.</code><code class="descname">System</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System" title="Permalink to this definition">¶</a></dt>
<dd><p>系统基类。需要扩展或实现更复杂的系统交易行为，可从此类继承。</p>
<dl class="attribute">
<dt id="hikyuu.trade_sys.System.name">
<code class="descname">name</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.name" title="Permalink to this definition">¶</a></dt>
<dd><p>系统名称</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.System.tm">
<code class="descname">tm</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.tm" title="Permalink to this definition">¶</a></dt>
<dd><p>关联的交易管理实例</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.System.mm">
<code class="descname">mm</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.mm" title="Permalink to this definition">¶</a></dt>
<dd><p>资金管理策略</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.System.ev">
<code class="descname">ev</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.ev" title="Permalink to this definition">¶</a></dt>
<dd><p>市场环境判断策略</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.System.cn">
<code class="descname">cn</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.cn" title="Permalink to this definition">¶</a></dt>
<dd><p>系统有效条件</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.System.sg">
<code class="descname">sg</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.sg" title="Permalink to this definition">¶</a></dt>
<dd><p>信号指示器</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.System.st">
<code class="descname">st</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.st" title="Permalink to this definition">¶</a></dt>
<dd><p>止损策略</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.System.tp">
<code class="descname">tp</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.tp" title="Permalink to this definition">¶</a></dt>
<dd><p>止盈策略</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.System.pg">
<code class="descname">pg</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.pg" title="Permalink to this definition">¶</a></dt>
<dd><p>盈利目标策略</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.System.sp">
<code class="descname">sp</code><a class="headerlink" href="system.html#hikyuu.trade_sys.System.sp" title="Permalink to this definition">¶</a></dt>
<dd><p>移滑价差算法</p>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.getParam">
<code class="descname">getParam</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.getParam" title="Permalink to this definition">¶</a></dt>
<dd><p>获取指定的参数</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; 参数名称</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">参数值</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><strong>out_of_range</strong> &#8211; 无此参数</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.setParam">
<code class="descname">setParam</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.setParam" title="Permalink to this definition">¶</a></dt>
<dd><p>设置参数</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>str</em>) &#8211; 参数名称</li>
<li><strong>value</strong> (<em>int | bool | float | string</em>) &#8211; 参数值</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>logic_error</strong> &#8211; Unsupported type! 不支持的参数类型</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.getTO">
<code class="descname">getTO</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.getTO" title="Permalink to this definition">¶</a></dt>
<dd><p>获取交易对象，即运行 <a class="reference internal" href="system.html#hikyuu.trade_sys.System.run" title="hikyuu.trade_sys.System.run"><code class="xref py py-meth docutils literal"><span class="pre">System.run()</span></code></a> 方法时，stock + query 获取到的 KData</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../base/datatype.html#hikyuu.KData" title="hikyuu.KData">KData</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.setTO">
<code class="descname">setTO</code><span class="sig-paren">(</span><em>self</em>, <em>kdata</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.setTO" title="Permalink to this definition">¶</a></dt>
<dd><p>设置交易对象，即运行 <code class="xref py py-meth docutils literal"><span class="pre">Systemrun()</span></code> 方法时，stock + query 获取到的 KData</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kdata</strong> (<a class="reference internal" href="../base/datatype.html#hikyuu.KData" title="hikyuu.KData"><em>KData</em></a>) &#8211; K线数据</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.getStock">
<code class="descname">getStock</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.getStock" title="Permalink to this definition">¶</a></dt>
<dd><p>获取关联的证券</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../stock_manager.html#hikyuu.Stock" title="hikyuu.Stock">Stock</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.getTradeRecordList">
<code class="descname">getTradeRecordList</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.getTradeRecordList" title="Permalink to this definition">¶</a></dt>
<dd><p>获取交易记录</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../trade_manage/record_struct.html#hikyuu.trade_manage.TradeRecordList" title="hikyuu.trade_manage.TradeRecordList">TradeRecordList</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.getBuyTradeRequest">
<code class="descname">getBuyTradeRequest</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.getBuyTradeRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>获取买入请求，“delay”模式下查看下一时刻是否存在买入操作</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="system.html#hikyuu.trade_sys.TradeRequest" title="hikyuu.trade_sys.TradeRequest">TradeRequest</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.getSellTradeRequest">
<code class="descname">getSellTradeRequest</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.getSellTradeRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>获取卖出请求，“delay”模式下查看下一时刻是否存在卖出操作</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="system.html#hikyuu.trade_sys.TradeRequest" title="hikyuu.trade_sys.TradeRequest">TradeRequest</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="hikyuu.trade_sys.System.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>self</em>, <em>stock</em>, <em>query</em><span class="optional">[</span>, <em>reset=True</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.run" title="Permalink to this definition">¶</a></dt>
<dd><p>运行系统，执行回测</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stock</strong> (<a class="reference internal" href="../stock_manager.html#hikyuu.Stock" title="hikyuu.Stock"><em>Stock</em></a>) &#8211; 交易的证券</li>
<li><strong>query</strong> (<a class="reference internal" href="../stock_manager.html#hikyuu.Query" title="hikyuu.Query"><em>Query</em></a>) &#8211; K线数据查询条件</li>
<li><strong>reset</strong> (<em>bool</em>) &#8211; 是否同时复位所有组件，尤其是tm实例</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>复位操作</p>
</dd></dl>

<dl class="method">
<dt id="hikyuu.trade_sys.System.clone">
<code class="descname">clone</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="system.html#hikyuu.trade_sys.System.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>克隆操作</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="id5">
<h2>交易请求记录<a class="headerlink" href="system.html#id5" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="hikyuu.trade_sys.TradeRequest">
<em class="property">class </em><code class="descclassname">hikyuu.trade_sys.</code><code class="descname">TradeRequest</code><a class="headerlink" href="system.html#hikyuu.trade_sys.TradeRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>交易请求记录。系统内部在实现延迟操作时登记的交易请求信息。暴露该结构的主要目的是用于在“delay”模式（延迟到下一个bar开盘时进行交易）的情况下，系统实际已知下一个Bar将要进行交易，此时可通过 <a class="reference internal" href="system.html#hikyuu.trade_sys.System.getBuyTradeRequest" title="hikyuu.trade_sys.System.getBuyTradeRequest"><code class="xref py py-meth docutils literal"><span class="pre">System.getBuyTradeRequest()</span></code></a> 、 <a class="reference internal" href="system.html#hikyuu.trade_sys.System.getSellTradeRequest" title="hikyuu.trade_sys.System.getSellTradeRequest"><code class="xref py py-meth docutils literal"><span class="pre">System.getSellTradeRequest()</span></code></a> 来获知下一个BAR是否需要买入/卖出。主要用于提醒或打印下一个Bar需要进行操作。对于系统本身的运行没有影响。</p>
<dl class="attribute">
<dt id="hikyuu.trade_sys.TradeRequest.valid">
<code class="descname">valid</code><a class="headerlink" href="system.html#hikyuu.trade_sys.TradeRequest.valid" title="Permalink to this definition">¶</a></dt>
<dd><p>该交易请求记录是否有效（True | False）</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.TradeRequest.business">
<code class="descname">business</code><a class="headerlink" href="system.html#hikyuu.trade_sys.TradeRequest.business" title="Permalink to this definition">¶</a></dt>
<dd><p>交易业务类型，参见：<a class="reference internal" href="../trade_manage/record_struct.html#hikyuu.trade_manage.BUSINESS" title="hikyuu.trade_manage.BUSINESS"><code class="xref py py-class docutils literal"><span class="pre">hikyuu.trade_manage.BUSINESS</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.TradeRequest.datetime">
<code class="descname">datetime</code><a class="headerlink" href="system.html#hikyuu.trade_sys.TradeRequest.datetime" title="Permalink to this definition">¶</a></dt>
<dd><p>发出交易请求的时刻</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.TradeRequest.stoploss">
<code class="descname">stoploss</code><a class="headerlink" href="system.html#hikyuu.trade_sys.TradeRequest.stoploss" title="Permalink to this definition">¶</a></dt>
<dd><p>发出交易请求时刻的止损价</p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.TradeRequest.part">
<code class="descname">part</code><a class="headerlink" href="system.html#hikyuu.trade_sys.TradeRequest.part" title="Permalink to this definition">¶</a></dt>
<dd><p>发出交易请求的来源，参见：<a class="reference internal" href="system.html#hikyuu.trade_sys.System.Part" title="hikyuu.trade_sys.System.Part"><code class="xref py py-class docutils literal"><span class="pre">System.Part</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="hikyuu.trade_sys.TradeRequest.count">
<code class="descname">count</code><a class="headerlink" href="system.html#hikyuu.trade_sys.TradeRequest.count" title="Permalink to this definition">¶</a></dt>
<dd><p>因操作失败，连续延迟的次数</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="environment.html" class="btn btn-neutral float-right" title="市场环境判定策略" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="trade_sys.html" class="btn btn-neutral" title="交易系统" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, fasiondog，&lt;a href=&#34;http://hikyuu.org/&#34;&gt;Hikyuu&lt;/a&gt;.
      
        <span class="commit">
          Revision <code>a0b7388d</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="../index.html">latest</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="http://readthedocs.org/projects/hikyuu/downloads/htmlzip/latest/">htmlzip</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="http://readthedocs.org/projects/hikyuu/?fromdocs=hikyuu">Project Home</a>
          </dd>
          <dd>
            <a href="http://readthedocs.org/builds/hikyuu/?fromdocs=hikyuu">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/underscore.js"></script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/doctools.js"></script>
      <script type="text/javascript" src="https://media.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>

  

  
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>